(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[863],{1004:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/upload",function(){return s(1205)}])},8076:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(5893);function n(e){let{children:t}=e;return(0,a.jsx)("div",{className:"container",children:t})}s(5836)},1205:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var a=s(5893),n=s(8076),i=s(9734),c=s(1955),l=s(1163),r=s(4055);let d=e=>{let t=(0,l.useRouter)();var s=c.Z.get("token")||!1;let n=e=>fetch(e,{headers:{"Content-Type":"application/json","x-vikram-token":s}}).then(e=>e.json()),{data:d,error:o,isLoading:u}=(0,i.ZP)("/api/checkauth",n);return u?(0,a.jsxs)("div",{className:"row",children:[(0,a.jsxs)("div",{className:"mx-auto col-10 col-md-8 col-lg-6 d-flex justify-content-center align-items-center mt-4",children:[" ",(0,a.jsx)(r.Z,{color:"#36d7b7",size:35})," "]})," "]}):(null==d?void 0:d.success)===!0?(0,a.jsx)("div",{children:e.children}):void((null==d?void 0:d.success)==!1&&t.push("/index"))};var o=s(7294),u=s(9669);let m=()=>{let[e,t]=(0,o.useState)(),s=(0,l.useRouter)(),[m,h]=(0,o.useState)(!0),[v,p]=(0,o.useState)(),[x,f]=(0,o.useState)(!1),[j,N]=(0,o.useState)(!1),[g,k]=(0,o.useState)(),b=c.Z.get("token")||"",y=e=>fetch(e,{headers:{"Content-Type":"application/json","x-vikram-token":b}}).then(async e=>{let t=await e.json();k(t.count),0===t.count&&N(!1)}),{data:w,error:_,isLoading:Z}=(0,i.ZP)("/api/status",y,{refreshInterval:5e3});(0,o.useEffect)(()=>{!async function(){await u.get("/api/status",{headers:{"x-vikram-token":c.Z.get("token")||""}}).then(async e=>{!0==e.data.success&&e.data.count>0?(N(!0),k(e.data.count)):N(!1)})}()},[N,k]);let S=e=>{p(""),"text/csv"==e.target.files[0].type?(h(!1),t(e.target.files[0])):(h(!0),p("Invalid File"))},E=async t=>{t.preventDefault(),f(!0);let a=new FormData;a.append("csv",e),a.append("fileName",e.name);let n={headers:{"content-type":"multipart/form-data","x-vikram-token":c.Z.get("token")||""}};await u.post("/api/upload",a,n).then(e=>{var t,a,n;(null===(t=e.data)||void 0===t?void 0:t.success)===!1&&(p(e.data.error),f(!1)),(null===(a=e.data)||void 0===a?void 0:a.success)===!0&&(N(!0),f(!1)),(null===(n=e.data)||void 0===n?void 0:n.redirect)&&s.push("/")})};return(0,a.jsx)(n.Z,{children:(0,a.jsxs)(d,{children:[j&&g>0?(0,a.jsxs)("div",{className:"row",children:[(0,a.jsxs)("div",{className:"mx-auto col-10 col-md-8 col-lg-6 d-flex  justify-content-center align-items-center mt-4",children:[(0,a.jsx)(r.Z,{color:"#36d7b7",size:35})," ",(0,a.jsxs)("div",{className:"ml-2 font-italic",children:["Only ",(0,a.jsxs)("span",{className:"text-info",children:[g," "]})," Left!!"]})]})," "]}):"",(0,a.jsx)("div",{className:"row",children:(0,a.jsx)("div",{className:"mx-auto col-10 col-md-8 col-lg-6",children:(0,a.jsx)("div",{className:"card mt-4",children:(0,a.jsxs)("form",{onSubmit:E,children:[(0,a.jsx)("div",{className:"card-header",children:"File Upload"}),(0,a.jsx)("div",{className:"card-body",children:(0,a.jsxs)("div",{className:"input-group mb-3",children:[(0,a.jsx)("input",{type:"file",className:"form-control",id:"inputGroupFile02",onChange:S}),(0,a.jsx)("label",{className:"input-group-text",children:"Upload"})]})}),(0,a.jsx)("div",{className:"card-footer text-muted",children:(0,a.jsx)("button",{disabled:m,type:"submit",className:"btn btn-info btn-md mt-2",children:x?"Loading..":"Save"})}),v?(0,a.jsx)("div",{className:"alert alert-danger m-4",children:v}):""]})})})})]})})};var h=m}},function(e){e.O(0,[774,752,883,679,888,179],function(){return e(e.s=1004)}),_N_E=e.O()}]);